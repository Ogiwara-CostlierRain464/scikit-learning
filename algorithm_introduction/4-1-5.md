# About
練習問題4-1-5:
最大部分配列問題を線形時間で解くアルゴリズムを記述せよ。

まず、コードは以下のようになる

```python
def linear_search(A):
    m = -INF
    low_m = high_m = None
    m_r = 0
    low_r = 1
    for i in count(1, A.length):
        m_r += A[i]
        if m_r > m:
            low_m = low_r
            high_m = i
            m = m_r
        if m_r < 0:
            m_r = 0
            low_r = i + 1

    return low_m, high_m, m
```

メモ変数`m, low_m, high_m, m_r, low_r`の意味が掴みにくいので、
配列`[13, -3, -23, 18, 20, -7, 12, -5, -22, 15, -4, 7]`
に対する挙動を示す。

| m  | low_m | high_m | m_r | low_r | i | A[i] |
|----|-------|--------|-----|-------|---|------|
| -∞ | NIL   | NIL    | 0   | 1     |   |      |
| 13 | 1     | 1      | 13  | 1     | 1 | 13   |
| 13 | 1     | 1      | 10  | 1     | 2 | -3   |
| 13 | 1     | 1      | 0   | 4     | 3 | -23  |
| 18 | 4     | 4      | 18  | 4     | 4 | 18   |
| 38 | 4     | 5      | 38  | 4     | 5 | 20   |
| 38 | 4     | 5      | 31  | 4     | 6 | -7   |
| 43 | 4     | 7      | 43  | 4     | 7 | 12   |

返り値から、

- m: 最大部分配列の和
- low_m: 最大部分配列の開始位置
- high_m: 最大部分配列の終了位置

を表すことがわかる。そうでないm_r, low_rはメモ変数(実際、_r (record) で終わる)
を表すことがわかる。
また、変数の依存関係を見ていくと、

- m_r <- A(i)
- low_m <- low_r
- high_m <- i
- m <- m_r

が見てとれ、m_rはその時点でのlow_rから始まる部分配列の和を、low_rは暫定的な
最大部分配列の開始位置を記録していることがわかる。

また、m_r < 0の時にメモ変数をリセットしているが、
これは「部分配列の和が負になったら、その時点でその部分配列が最大部分配列になることはあり得ない」
と解釈できる。 この時、m_rとlow_rをリセットし、次に正の数が出てきた時点でその部分から最大部分配列を記録する。

m_rで(0になる度に)総和を記録しておき、総和がmを超えたらm = m_r, low_m = low_r, high_m = iで更新する。


ループ不変式:
`A[1..j]`の最大部分配列がわかっている。

このアルゴリズムのループ不変式が成り立つことを証明し、正当性を示す必要がある。
